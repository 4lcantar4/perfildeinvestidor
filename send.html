<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Resultados do Quiz</title>
    <link rel="stylesheet" href="stylesend.css" />
    <link rel="stylesheet" href="https://unpkg.com/swiper/swiper-bundle.min.css"/>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://unpkg.com/swiper/swiper-bundle.min.js"></script>
    <!-- Adicione aqui o restante do seu CSS existente e quaisquer outros <link> ou <style> necessários -->
</head>
<body>
    <div class="container">
        <br><br>
        <h1 class="heading"> Resultados do Quiz</h1>
        <hr>
        <br>
        <div class="start-screen">
            <p class="question" style="display: flex;flex-direction: column" id="mensagem">
                Obrigado por participar!
                <br><br/>
                Aguarde alguns instantes estamos salvando as respostas e calculando seu resultado!
            </p>
            <br><br/>
            <!-- Spinner de carregamento -->
            <div class="loader" id="spinner"></div>
            <br>
            <!-- Swiper container que será exibido após o cálculo do coeficiente -->
            <div class="swiper-container" style="display: none;">
                <div class="swiper-wrapper">
                    <!-- Adicione aqui os slides do Swiper -->
                    <!-- Exemplo de um slide: -->
                    <div class="swiper-slide">
                        <div class="title">Perfil: Aventureiro</div>
                        <p class="description">
                            Busca emoção no mercado e está disposto a assumir riscos elevados em busca de ganhos expressivos. O investidor aventureiro é movido pela busca incessante de oportunidades ousadas, priorizando retornos extraordinários em detrimento do medo de perdas significativas. Considera λ, indicando intensa preferência por obter ganhos.
                        </p>
                        <div class="lambda">Intervalo de λ: 0 < λ < 0,5</div>
                    </div>
                    <!-- Slide 2: Perfil Arrojado -->
                    <div class="swiper-slide">
                        <div class="title">Perfil: Arrojado</div>
                        <p class="description">
                            Disposto a correr riscos consideráveis para buscar ganhos expressivos, mantendo alguma cautela. Busca uma rentabilidade atraente e valoriza a diversificação da carteira. Considera λ, indicando preferência moderada por obter ganhos.
                        </p>
                        <div class="lambda">Intervalo de λ: 0,5 ≤ λ < 1</div>
                    </div>
                    <!-- Slide 3: Perfil Moderado -->
                    <div class="swiper-slide">
                        <div class="title">Perfil: Moderado</div>
                        <p class="description">
                            Equilíbrio entre risco e retorno, disposto a correr riscos moderados, buscando uma boa rentabilidade e valorizando a diversificação da carteira. Considera λ, indicando aversão à perda entre neutra e baixa.
                        </p>
                        <div class="lambda">Intervalo de λ: 1 ≤ λ < 1,75</div>
                    </div>
                    <!-- Slide 4: Perfil Equilibrado -->
                    <div class="swiper-slide">
                        <div class="title">Perfil: Equilibrado</div>
                        <p class="description">
                            Prefere um equilíbrio razoável entre rentabilidade e segurança, aberto a riscos moderados e adaptando estratégias de acordo com o mercado. Considera λ, indicando aversão à perda um pouco mais elevada.
                        </p>
                        <div class="lambda">Intervalo de λ: 1,75 ≤ λ < 2,5</div>
                    </div>
                    <!-- Slide 5: Perfil Conservador -->
                    <div class="swiper-slide">
                        <div class="title">Perfil: Conservador</div>
                        <p class="description">
                            Prioriza a proteção do capital, disposto a correr riscos baixos para obter ganhos, valorizando investimentos de baixo risco e média liquidez. Considera λ, indicando aversão à perda significativa.
                        </p>
                        <div class="lambda">Intervalo de λ: 2,5 ≤ λ < 4</div>
                    </div>
                    <!-- Slide 6: Perfil Cauteloso -->
                    <div class="swiper-slide">
                        <div class="title">Perfil: Cauteloso</div>
                        <p class="description">
                            Preocupa-se principalmente com a segurança, evitando riscos de perda a todo custo, optando por investimentos de renda fixa com garantias sólidas. Considera λ, indicando aversão à perda mais intensa.
                        </p>
                        <div class="lambda">Intervalo de λ: λ ≥ 4</div>
                    </div>
                </div>
                <!-- Add Pagination -->
                <div class="swiper-pagination"></div>
                <!-- Add Navigation -->
                <div class="swiper-button-next"></div>
                <div class="swiper-button-prev"></div>
            </div>
            <!-- Fim do Swiper -->
            <div>
                <button class="quit" id="restartbutton" style="display: none;">Reenviar</button>
                <a class="btn" href="https://sites.google.com/view/seuperfildeinvestidor/" style="margin-top: 10px; display: none;" id="verPerfisButton">Ver os perfis de aversão à perda</a>
            </div>
        </div>
    </div>


    <script type="text/javascript">
        // Evento para o botão de reenvio
        document.getElementById("restartbutton").addEventListener("click", function() {
            document.getElementById("restartbutton").style.display = "none";
            sendInformation();
        });
    
        // Função para enviar as informações
        function sendInformation() {
            let data = {};
            data.SocioEconomics = JSON.parse(localStorage.SocioEconomics);
            data.RiskAverssion = JSON.parse(localStorage.RiskAverssion);
            data.Quiz = JSON.parse(localStorage.Quiz);
    
            let jsonData = JSON.stringify(data);
            let encodedData = encodeURIComponent(jsonData);
    
            let url = `https://script.google.com/macros/s/AKfycby7vlwGMpMw36HLgxlYpsP4C7g0GK5a2rVUHdUeyNDGzlYGSzv6zlXLmx0vVpor3hI3tQ/exec?data=${encodedData}`;
    
            fetch(url, {
                method: "GET"
            }).then(response => {
                sucessoNoEnvio();
            }).catch(error => {
                falhaNoEnvio();
            });
        }
    
        // Função para lidar com sucesso no envio
        function sucessoNoEnvio() {
            document.getElementById("spinner").style.display = "none";
            calcularEExibirCoeficiente();
        }
    
        // Função para lidar com falha no envio
        function falhaNoEnvio() {
            document.getElementById("spinner").style.display = "none";
            document.getElementById("mensagem").textContent = "Ops..algo deu errado, clique no botão abaixo";
            document.getElementById("restartbutton").style.display = "block";
        }
    
        // Variável para armazenar a instância do Swiper
        var swiperInstance;
    
        // Função para calcular e exibir o coeficiente e inicializar o Swiper
        function calcularEExibirCoeficiente() {
            if (localStorage.Quiz) {
                const quiz = JSON.parse(localStorage.Quiz);
                const coeficiente = quiz.etapa1 / quiz.etapa3;
                let mensagemEl = document.querySelector('#mensagem');
                mensagemEl.innerHTML = "Seu coeficiente de aversão: " + coeficiente.toFixed(2) + "<br/><br/>" +
                                       "TEXTO1: Caso você queira consultar depois, printe a tela ou anote essa informação.<br/><br/>";
                iniciarSwiper();
                document.getElementById("verPerfisButton").style.display = "block";
                mensagemEl.innerHTML += "TEXTO3: Nota"; // Adiciona mais conteúdo ao HTML se necessário
            }
        }
    
        // Função para inicializar o Swiper
        function iniciarSwiper() {
            if (!swiperInstance) { // Verifica se o Swiper já foi inicializado
                swiperInstance = new Swiper('.swiper-container', {
                    slidesPerView: 1,
                    spaceBetween: 30,
                    loop: true,
                    pagination: {
                        el: '.swiper-pagination',
                        clickable: true,
                    },
                    navigation: {
                        nextEl: '.swiper-button-next',
                        prevEl: '.swiper-button-prev',
                    },
                });
                document.getElementById('swiper-container').style.display = "block"; // Mostrar o Swiper após inicializá-lo
            }
        }
    
        // Inicializa o envio das informações
        sendInformation();
    </script>
    
</body>
</html>


