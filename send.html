<!DOCTYPE html>
<head>

<link href="https://fonts.googleapis.com/css?family=Montserrat:300,400,700%7CRoboto:400,700" rel="stylesheet">
<script src="https://kit.fontawesome.com/a076d05399.js" crossorigin="anonymous"></script>
<link href='style.css' rel='stylesheet' type='text/css'>
<title>Teste de Adequação de Investimentos</title>
<meta charset="utf-8">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
</head>

<body>

<div class="main">
<br><br>
<h1>Teste de Adequação de Investimentos</h1>
<br>

<br>

<p class="question" style="display: flex;flex-direction: column"> Prezado(a) participante, <br>
    Agradecemos a participação, estamos enviando as respostas!<br>
    Status: <span id="statusSend" style="font-size: 36pt; color:red">Não enviado... Aguarde!</span>
</p>
<br>
<br>
<button class="button" style="background-color: red" id="restartbutton" >Reenviar</button>
<a class="button" href="https://sites.google.com/view/seuperfildeinvestidor/" style="margin-top: 10px">Ver os perfis de aversão à perda</a>



</div>

    <script type="text/javascript">

        document.getElementById("restartbutton").addEventListener("click", function() {
            document.getElementById("restartbutton").disabled = true;
            alterarStatus(false)
            sendInformation()
            setTimeout(() => {document.getElementById("restartbutton").disabled = false }, 10000)
            });

        document.getElementById("restartbutton").disabled = true;

        function alterarStatus(status = true){
            const not_send_text = "Não enviado... Aguarde!"
            const send_text = "Enviado!"
            const not_send_color = "red"
            const send_color = "blue"

            const elemento = document.getElementById("statusSend");
            if (status) {
                elemento.textContent = send_text
                elemento.style.color = send_color
            } else {
                elemento.textContent = not_send_text
                elemento.style.color = not_send_color
            }
        }

        function sendInformation(){
            let data = {}
            data.SocioEconomics = JSON.parse(localStorage.SocioEconomics)
            data.RiskAverssion = JSON.parse(localStorage.RiskAverssion)
            data.Quiz = JSON.parse(localStorage.Quiz)

            let jsonData = JSON.stringify(data);

            let encodedData = encodeURIComponent(jsonData);

            let url = `https://script.google.com/macros/s/AKfycby7vlwGMpMw36HLgxlYpsP4C7g0GK5a2rVUHdUeyNDGzlYGSzv6zlXLmx0vVpor3hI3tQ/exec?data=${encodedData}`;

            fetch(url, {
                method: "GET"
            }).then(response => {
                alterarStatus()
            })
                .catch(error => {
                    console.error("Erro", error);
                })
            document.getElementById("restartbutton").disabled = false;
        }

    sendInformation()
	    
    </script>

</body>

</html>
